)]}'
{"version":3,"file":"/packages/yogiben:autoform-file.js","sources":["yogiben:autoform-file/lib/client/autoform-file.html","yogiben:autoform-file/lib/client/autoform-file.coffee"],"names":[],"mappings":"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","sourcesContent":["\nTemplate.__checkName(\"afFileUpload\");\nTemplate[\"afFileUpload\"] = new Template(\"Template.afFileUpload\", (function() {\n  var view = this;\n  return [ HTML.Raw('<!-- <div class=\"form-group file-upload invisible\"> -->\\n\t\t'), HTML.DIV({\n    \"class\": \"form-group file-upload\"\n  }, \"\\n\t\t\t\", Blaze._TemplateWith(function() {\n    return {\n      name: Spacebars.call(view.lookup(\"name\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"afFieldLabel\"));\n  }), \"\\n\t\t\t\", HTML.Raw(\"<br>\"), \"\\n\t\t\t\", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"fileUpload\"), view.lookup(\"name\"), view.lookup(\"collection\"), view.lookup(\"label\"));\n  }, function() {\n    return [ \"\\n\t\t\t\", Spacebars.With(function() {\n      return Spacebars.dataMustache(view.lookup(\"fileUpload\"), view.lookup(\"name\"), view.lookup(\"collection\"), view.lookup(\"label\"));\n    }, function() {\n      return [ \"\\n\t\t\t\t\", Blaze._TemplateWith(function() {\n        return {\n          template: Spacebars.call(view.lookup(\"template\")),\n          data: Spacebars.call(view.lookup(\"data\"))\n        };\n      }, function() {\n        return Spacebars.include(function() {\n          return Spacebars.call(Template.__dynamic);\n        });\n      }), \"\\n\t\t\t\" ];\n    }), \"\\n\t\t\t\", HTML.BR(), \"\\n\t\t\t\", HTML.A({\n      \"class\": \"file-upload-clear\",\n      \"file-input\": function() {\n        return Spacebars.mustache(view.lookup(\"name\"));\n      }\n    }, HTML.I({\n      \"class\": \"fa fa-times\"\n    }), \" Remove\"), \"\\n\t\t\t\" ];\n  }, function() {\n    return [ \"\\n\t\t\t\", HTML.LABEL({\n      \"for\": function() {\n        return [ \"file-\", Spacebars.mustache(view.lookup(\"name\")) ];\n      },\n      \"class\": \"btn btn-default\"\n    }, \"\\n\t\t\t\tChoose file\\n\t\t\t\t\", HTML.INPUT({\n      \"class\": \"hidden\",\n      id: function() {\n        return [ \"file-\", Spacebars.mustache(view.lookup(\"name\")) ];\n      },\n      \"file-input\": function() {\n        return Spacebars.mustache(view.lookup(\"name\"));\n      },\n      collection: function() {\n        return Spacebars.mustache(view.lookup(\"collection\"));\n      },\n      type: \"file\"\n    }), \"\\n\t\t\t\"), \"\\n\t\t\t\" ];\n  }), \"\\n\t\t\t\", HTML.DIV({\n    \"class\": \"\"\n  }, Blaze._TemplateWith(function() {\n    return {\n      name: Spacebars.call(view.lookup(\"name\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n  })), \"\\n\t\t\") ];\n}));\n\nTemplate.__checkName(\"fileThumbIcon\");\nTemplate[\"fileThumbIcon\"] = new Template(\"Template.fileThumbIcon\", (function() {\n  var view = this;\n  return HTML.A({\n    \"class\": \"btn btn-default\",\n    target: \"_blank\"\n  }, \"\\n\t\t\", HTML.I({\n    \"class\": function() {\n      return [ \"fa fa-\", Spacebars.mustache(view.lookup(\"icon\")) ];\n    }\n  }), \" \", Blaze.View(function() {\n    return Spacebars.mustache(view.lookup(\"src\"));\n  }), \"\\n\t\");\n}));\n\nTemplate.__checkName(\"fileThumbImg\");\nTemplate[\"fileThumbImg\"] = new Template(\"Template.fileThumbImg\", (function() {\n  var view = this;\n  return HTML.IMG({\n    src: function() {\n      return Spacebars.mustache(view.lookup(\"src\"));\n    },\n    alt: \"\",\n    \"class\": \"img-fileUpload-thumbnail img-thumbnail img-rounded\"\n  });\n}));\n","refreshFileInput = (name)->\n\tcallback = ->\n\t\t# id = $('.nav-pills[file-input=\"'+name+'\"] > .active > a').attr('href')\n\t\t# value = $('.tab-content[file-input=\"'+name+'\"] >' + id + '>div>input').val()\n\t\t# $('input[name=\"' + name + '\"]').val(value)\n\t\t# console.log name\n\t\tvalue = $('input[name=\"' + name + '\"]').val()\n\t\tSession.set 'fileUpload['+name+']', value\n\tsetTimeout callback, 10\n\ngetIcon = (file)->\n\tfile = file.toLowerCase()\n\ticon = 'file-o'\n\tif file.indexOf('youtube.com') > -1\n\t\ticon = 'youtube'\n\telse if file.indexOf('vimeo.com') > -1\n\t\ticon = 'vimeo-square'\n\telse if file.indexOf('.pdf') > -1\n\t\ticon = 'file-pdf-o'\n\telse if file.indexOf('.doc') > -1 || file.indexOf('.docx') > -1\n\t\ticon = 'file-word-o'\n\telse if file.indexOf('.ppt') > -1\n\t\ticon = 'file-powerpoint-o'\n\telse if file.indexOf('.avi') > -1 || file.indexOf('.mov') > -1 || file.indexOf('.mp4') > -1\n\t\ticon = 'file-movie-o'\n\telse if file.indexOf('http://') > -1 || file.indexOf('https://') > -1\n\t\ticon = 'link'\n\ticon\n\ngetTemplate = (file)->\n\ttemplate = 'fileThumbIcon'\n\tif file.indexOf('.jpg') > -1 || file.indexOf('.png') > -1 || file.indexOf('.gif') > -1\n\t\ttemplate = 'fileThumbImg'\n\ttemplate\n\nTemplate.afFileUpload.rendered = () ->\n\tdoc = Template.parentData(1)._af.doc\n\tdata = Template.currentData()\n\n\nTemplate.afFileUpload.destroyed = () ->\n\tname = @data.name\n\tSession.set 'fileUpload['+name+']', null\n\nTemplate.afFileUpload.events\n\t\"change .file-upload\": (e, t) ->\n\t\tfiles = e.target.files\n\t\tcollection = $(e.target).attr('collection')\n\t\twindow[collection].insert files[0], (err, fileObj) ->\n\t\t\tname = $(e.target).attr('file-input')\n\t\t\t# console.log $(e.target)\n\t\t\t# console.log fileObj\n\t\t\t$('input[name=\"'+name+'\"]').val(fileObj._id)\n\t\t\tSession.set 'fileUploadSelected['+name+']', files[0].name\n\t\t\t# console.log fileObj\n\t\t\trefreshFileInput name\n\t'click .file-upload-clear': (e,t)->\n\t\tname = $(e.currentTarget).attr('file-input')\n\t\t$('input[name=\"' + name + '\"]').val('')\n\t\tSession.set 'fileUpload['+name+']', 'delete-file'\n\nTemplate.afFileUpload.helpers\n\tfileUpload: (name,collection) ->\n\t\tdoc = Template.parentData(1)._af.doc\n\n\t\tif Session.equals('fileUpload['+name+']', 'delete-file')\n\t\t\treturn null\n\t\telse if Session.get('fileUpload['+name+']')\n\t\t\tfile = Session.get('fileUpload['+name+']')\n\t\telse\n\t\t\tif name.indexOf('.') > -1\n\t\t\t\tname = name.split('.')\n\t\t\t\tfile = doc[name[0]]?[name[1]]\n\t\t\telse\n\t\t\t\tfile = doc[name]\n\n\t\tif file != '' && file\n\t\t\tif file.length == 17\n\t\t\t\tdoc = window[collection].findOne({_id:file})\n\t\t\t\tfilename = window[collection].findOne({_id:file}).name()\n\t\t\t\tsrc = window[collection].findOne({_id:file}).url()\n\t\t\telse\n\t\t\t\tfilename = file\n\t\t\t\tsrc = filename\n\t\t\tobj = \n\t\t\t\ttemplate: getTemplate(filename)\n\t\t\t\tdata:\n\t\t\t\t\tsrc: src\n\t\t\t\t\ticon: getIcon(filename)\n\t\t\tobj\n\tfileUploadSelected: (name)->\n\t\tSession.get 'fileUploadSelected['+name+']'\n\tisUploaded: (name,collection) ->\n\t\tfile = Session.get 'fileUpload['+name+']'\n\t\tisUploaded = false\n\t\tif file && file.length == 17\n\t\t\tdoc = window[collection].findOne({_id:file})\n\t\t\tisUploaded = doc.isUploaded()\n\t\telse\n\t\t\tisUploaded = true\n\t\tisUploaded\n\n\tgetFileByName: (name,collection)->\n\t\tfile = Session.get 'fileUpload['+name+']'\n\t\tif file && file.length == 17\n\t\t\tdoc = window[collection].findOne({_id:file})\n\t\t\tconsole.log doc\n\t\t\tdoc\n\t\telse\n\t\t\tnull"]}